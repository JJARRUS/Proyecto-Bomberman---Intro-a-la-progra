import random

niveles = {
    1: [
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", "D", " ", " ", " ", "I"],
        ["I", " ", "I", " ", " ", " ", "I", " ", " ", " ", "I", " ", "I"],
        ["I", "D", " ", " ", " ", " ", " ", " ", " ", " ", " ", "D", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", "D", " ", " ", "I"],
        ["I", " ", "I", " ", " ", "I", " ", "I", " ", " ", "I", " ", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", "D", " ", " ", " ", "I"],
        ["I", " ", "I", " ", " ", " ", "I", " ", " ", " ", "I", " ", "I"],
        ["I", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", "D", " ", " ", " ", "I"],
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
    ],
    2: [
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", "D", " ", " ", " ", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", "D", " ", "D", " ", " ", " ", " ", " ", " ", " ", "D", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", "I", "D", "I", " ", "I"],
        ["I", " ", " ", "D", " ", "D", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", " ", " ", "I", " ", "I"],
        ["I", " ", " ", " ", " ", " ", " ", " ", " ", "D", " ", " ", "I"],
        ["I", " ", "I", "D", "D", "D", "I", " ", " ", "D", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", " ", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
    ],

    3: [
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", "D", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", "D", " ", " ", "D", " ", " ", " ", " ", " ", " ", "D", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", " ", "D", " ", "D", " ", " ", "D", " ", " ", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", "D", " ", " ", "D", " ", " ", " ", " ", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", "I", "D", "I", " ", "I"],
        ["I", " ", " ", "D", "D", " ", " ", "D", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", "D", "I", " ", "I"],
        ["I", " ", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
    ],

    4: [
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", "D", "I"],
        ["I", " ", "I", "D", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", " ", " ", "D", " ", " ", " ", " ", " ", " ", " ", " ", "I"],
        ["I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I", " ", "I"],
        ["I", "D", " ", "D", " ", " ", " ", " ", " ", " ", " ", "D", "I"],
        ["I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I", "I"],
    ]
}

def obtener_matriz_y_posiciones(nivel):
    if nivel not in niveles:
        raise ValueError(f"Nivel {nivel} no definido.")

    matriz = [fila.copy() for fila in niveles[nivel]]
    destructibles = []

    for fila in range(len(matriz)):
        for col in range(len(matriz[0])):
            if matriz[fila][col] == 'D':
                destructibles.append((fila, col))

    if len(destructibles) < 2:
        raise ValueError("No hay suficientes bloques destructibles para llave y puerta.")

    # Elegir dos bloques destructibles diferentes para llave y puerta
    llave_idx, puerta_idx = random.sample(range(len(destructibles)), 2)
    fila_llave, col_llave = destructibles[llave_idx]
    fila_puerta, col_puerta = destructibles[puerta_idx]

    llave_pos = (col_llave * 32, fila_llave * 32)
    puerta_pos = (col_puerta * 32, fila_puerta * 32)

    return matriz, llave_pos, puerta_pos, (fila_llave, col_llave)
